from __future__ import annotationsimport telemetry_helperfrom sims4 import protocol_buffer_utilsfrom typing import TYPE_CHECKINGif TYPE_CHECKING:
    from typing import *
    from sims.sim_info import SimInfo
    from traits.preference import Preference
    from traits.traits import Trait
    from protocolbuffers import FileSerialization_pb2 as serializationimport mathimport mtximport protocolbuffersimport randomimport servicesimport sims4.logfrom cas.cas import generate_random_siminfofrom date_and_time import DATE_AND_TIME_ZEROfrom distributor.rollback import ProtocolBufferRollbackfrom distributor.ops import ShowMatchmakingDialogfrom distributor.system import Distributorfrom event_testing.test_events import TestEventfrom filters.tunable import TunableSimFilter, FilterTermVariant, AgeFilterTerm, GenderFilterTerm, GallerySimFilterTerm, TraitBlacklistFilterTermfrom interactions.utils.tunable_icon import TunableIconAllPacksfrom matchmaking.matchmaking_enum import ProfileTypefrom matchmaking.matchmaking_profiles import MatchmakingData, MatchmakingProfilefrom persistence_error_types import ErrorCodesfrom protocolbuffers import Sims_pb2from protocolbuffers.GameplaySaveData_pb2 import GameplayOptionsfrom protocolbuffers.ResourceKey_pb2 import ResourceKeyfrom relationships.global_relationship_tuning import RelationshipGlobalTuningfrom relationships.relationship_track import RelationshipTrackfrom sims.global_gender_preference_tuning import GenderPreferenceType, GlobalGenderPreferenceTuning, ExploringOptionsStatusfrom sims.household_enums import HouseholdChangeOriginfrom sims.household_manager import HouseholdFixupHelperfrom sims.sim_info_base_wrapper import SimInfoBaseWrapperfrom sims.sim_info_types import Age, Gender, Speciesfrom sims.sim_spawner import SimSpawner, SimCreatorfrom sims4.common import Packfrom sims4.service_manager import Servicefrom sims4.tuning.tunable import Tunable, TunableEnumEntry, TunableEnumSet, TunableMapping, TunableRange, TunableReference, TunablePackSafeReference, TunableList, TunableTuplefrom sims4.protocol_buffer_utils import has_fieldfrom sims4.utils import classpropertyfrom traits.trait_type import TraitTypefrom tunable_time import TunableTimeSpanfrom ui.ui_dialog_notification import TunableUiDialogNotificationSnippetlogger = sims4.log.Logger('Matchmaking', default_owner='sucywang')TELEMETRY_GROUP_MATCHMAKING = 'MAMK'TELEMETRY_HOOK_REFRESH = 'RFSH'TELEMETRY_FIELD_REFRESH_ACTION = 'rfsh'writer = sims4.telemetry.TelemetryWriter(TELEMETRY_GROUP_MATCHMAKING)NUM_NPCS_FROM_GALLERY = 1NUM_TRAITS_TO_DISPLAY = 2ON_CONTACT_NPC_REL_GAIN = 10MAX_POSE_INDEX = 8SIM_INFO_CAP = 600